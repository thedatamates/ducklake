# name: test/sql/transaction/transaction_insert_update_delete.test
# description: test ducklake extension
# group: [transaction]

require ducklake

require parquet

test-env DUCKLAKE_CONNECTION __TEST_DIR__/{UUID}.db

test-env DATA_PATH __TEST_DIR__

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS ducklake (DATA_PATH '${DATA_PATH}/transaction_insert_update_delete/', METADATA_CATALOG 'metadata', CATALOG 'test');

statement ok
USE ducklake;

statement ok
CREATE TABLE t1(c1 int);

statement ok
BEGIN;

statement ok
INSERT INTO t1 VALUES (1), (2);

statement ok
UPDATE t1 SET c1 = 3 WHERE c1 = 1;

statement ok
DELETE FROM t1 WHERE c1 = 2;

query I
FROM t1;
----
3