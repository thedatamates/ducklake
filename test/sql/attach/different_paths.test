# name: test/sql/attach/different_paths.test
# description: test attach of ducklake when providing different paths
# group: [attach]

require ducklake

require parquet

statement ok
ATTACH 'ducklake:__TEST_DIR__/some.db' AS a_ducklake (DATA_PATH '__TEST_DIR__/some/', CATALOG 'test', CREATE_IF_NOT_EXISTS true);

statement ok
USE a_ducklake;

statement ok
CREATE TABLE t AS SELECT range a FROM range(10);

statement ok
USE memory;

statement ok
DETACH a_ducklake;

statement error
ATTACH 'ducklake:__TEST_DIR__/some.db' AS other_ducklake (DATA_PATH '__TEST_DIR__/other_path/', CATALOG 'test', CREATE_IF_NOT_EXISTS true);
----
does not match existing data path in the catalog

statement ok
ATTACH 'ducklake:__TEST_DIR__/some.db' AS other_ducklake (DATA_PATH '__TEST_DIR__/other_path/', OVERRIDE_DATA_PATH TRUE, CATALOG 'test', CREATE_IF_NOT_EXISTS true);

# This will obviously not work, different OSs have different error messages saying file not found
statement error
FROM other_ducklake.t;
----
