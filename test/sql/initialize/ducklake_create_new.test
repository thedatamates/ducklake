# name: test/sql/initialize/ducklake_create_new.test
# description: test ducklake extension
# group: [initialize]

require ducklake

require parquet

# CATALOG is mandatory
statement error
ATTACH 'ducklake:__TEST_DIR__/ducklake_missing_catalog.db' AS ducklake
----
CATALOG is required. Please provide CATALOG when attaching the database.

# CREATE_IF_NOT_EXISTS defaults to false
statement error
ATTACH 'ducklake:__TEST_DIR__/ducklake_non_existent.db' AS ducklake (CATALOG 'test')
----
creating a new DuckLake is explicitly disabled

# create a new one
statement ok
ATTACH 'ducklake:__TEST_DIR__/ducklake_existent.db' AS ducklake (CREATE_IF_NOT_EXISTS true, CATALOG 'test')

statement ok
DETACH ducklake;

# we can attach to an existing ducklake
statement ok
ATTACH 'ducklake:__TEST_DIR__/ducklake_existent.db' AS ducklake (CREATE_IF_NOT_EXISTS false, CATALOG 'test')
