# name: test/sql/initialize/read_only_mode.test
# description: test ducklake on realy only mode
# group: [initialize]

require ducklake

require parquet

statement ok
ATTACH '__TEST_DIR__/ducklake_read_only.db' AS db1

statement ok
DETACH db1;

statement error
ATTACH 'ducklake:__TEST_DIR__/ducklake_read_only.db' AS ducklake (READONLY 1, CREATE_IF_NOT_EXISTS false, CATALOG 'test')
----
creating a new DuckLake is explicitly disabled

statement error
ATTACH 'ducklake:__TEST_DIR__/ducklake_read_only.db' AS ducklake (READONLY 1, CATALOG 'test')
----
creating a new DuckLake is explicitly disabled

statement error
ATTACH 'ducklake:__TEST_DIR__/ducklake_read_only.db' AS ducklake (READONLY 1, CREATE_IF_NOT_EXISTS true, CATALOG 'test')
----
"CREATE" on database "__ducklake_metadata_ducklake" which is attached in read-only mode!
