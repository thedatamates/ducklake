# name: test/sql/cloud/test_cloud_cases.test
# description: test ducklake extension
# group: [cloud]

require ducklake

require parquet

test-env DUCKLAKE_CONNECTION __TEST_DIR__/{UUID}.db

test-env DATA_PATH __TEST_DIR__

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS lake (DATA_PATH '${DATA_PATH}/test_cloud_cases/', METADATA_CATALOG 'metadata', CATALOG 'test');

statement ok
use lake;

statement ok
CREATE TABLE test AS FROM range (10) t(i);

statement ok
START;

statement ok
DELETE FROM test where i = 1;

statement ok
DELETE FROM test where i = 2;

statement ok
COMMIT;

query I
select * from test order by all;
----
0
3
4
5
6
7
8
9